<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="{{pluResPath}}github/security/index.css" />
    <link rel="shortcut icon" href="#" />
</head>
{{@headStyle}}

<body>
<div class="container" id="container">
    <div class="header">
        <div class="header-left">
            <img class="github-icon" src="{{pluResPath}}img/icon/github.png"/>
            <div class="event-type">GitHub Security Alert</div>
        </div>
        <div class="timestamp">{{time}}</div>
    </div>

    <div class="repo-info">
        <img class="repo-avatar" src="{{repoAvatar}}" />
        <div class="repo-details">
            <div class="repo-name">{{repoName}}</div>
            <div class="repo-description">{{description}}</div>
        </div>
    </div>

    <div class="alert-card {{alert_level}}">
        <div class="alert-header">
            <svg class="alert-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
            </svg>
            <div class="alert-title">
                {{alertType}} - {{severity}} Severity
            </div>
        </div>

        <div class="vulnerability-info">
            <div class="detail-row">
                <div class="detail-label">Package</div>
                <div class="detail-value">{{package}}</div>
            </div>
            <div class="detail-row">
                <div class="detail-label">Vulnerable Version</div>
                <div class="detail-value">{{vulnerableVersion}}</div>
            </div>
            <div class="detail-row">
                <div class="detail-label">Fixed In</div>
                <div class="detail-value">{{fixedVersion || 'Not available'}}</div>
            </div>
            <div class="detail-row">
                <div class="detail-label">CVSS Score</div>
                <div class="detail-value">{{cvssScore || 'Not provided'}}</div>
            </div>
        </div>

        <div class="alert-description">
            <div class="description-title">Description</div>
            <div class="description-content">{{description}}</div>
        </div>

        {{ if recommendations }}
        <div class="recommendations">
            <div class="recommendations-title">Recommendations</div>
            <ul class="recommendations-list">
                {{each recommendations recommendation}}
                <li class="recommendation-item">{{recommendation}}</li>
                {{/each}}
            </ul>
        </div>
        {{ /if }}

        <div class="alert-footer">
            <a href="{{url}}" class="view-alert">View Full Details</a>
        </div>
    </div>

    <div class="footer">
        <div class="footer-text">Created by Yunzai-Bot and GitHub-Plugin</div>
    </div>
</div>
</body>
</html>
